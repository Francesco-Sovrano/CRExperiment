<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{title}}</title>
   	<!-- Requires jQuery -->
	<script src="{{ url_for('static', filename='js/jquery.min.js')}}" type="text/javascript"></script>

    <!-- Requires CodeMirror -->
    <script src="{{ url_for('static', filename='js/codemirror.js')}}" type="text/javascript"></script>
    <script src="{{ url_for('static', filename='mode/clike/clike.js')}}" type="text/javascript"></script>

    <link rel="stylesheet" media="all" href="{{ url_for('static', filename='css/codemirror.css')}}" />

    <!-- Requires Mergely -->
    <script src="{{ url_for('static', filename='js/mergely.js')}}" type="text/javascript"></script>
    <link rel="stylesheet" media="all" href="{{ url_for('static', filename='css/mergely.css')}}" />

    <link rel="stylesheet" media="all" href="{{ url_for('static', filename='css/style.css')}}" />

    <!-- Script for diff production -->
    <script src="{{ url_for('static', filename='js/experiment.js')}}" type="text/javascript"></script>
    <style>
        .lint-error {font-family: arial; font-size: 80%; background: #fcfa96; color: #a00; padding: 2px 5px 3px; border: 1px solid black;}
        .lint-error-icon {color: white; background-color: red; font-weight: bold; border-radius: 50%; padding: 0 3px; margin-right: 7px;}
    </style>

    <script type="text/javascript">
        $(document).ready(function () {
            logData("pageLoaded", "pageLoaded")

            $("#button-continue").click(function(){
                $("#div-mergely").show();
                $("#button-continue").hide();
                logData("read_instructions", "read_instructions");
                var width = $(window).width() - 50;
                {% for code in codes %}
                    initMergely('#compare{{code["id"]}}',
                        parseInt('{{code["linecount"]}}') * 18.5 + 17,
                        parseInt('{{code["contextLineCount"]}}') * 18.5,
                        width,
                        parseInt('{{code["left_line_number"]}}'),
                        '{{code["left_content"] | safe}}',
                        parseInt('{{code["right_line_number"]}}'),
                        '{{code["right_content"] | safe}}',
                        '{{code["prefix_line_count"]}}',
                        '{{code["prefix_escaped"]}}',
                        '{{code["suffix_escaped"]}}',
                        '{{code["comment_user"]}}',
                        '{{code["comment"]}}',
                        '{{code["code_suggestion_L"]}}',
                        '{{code["code_suggestion_R"]}}',);
                {% endfor %}
            })
        });

        function showquestions(){
            logData("end_cr_experiment", "clickshowquestions")
            $("#review-completed").hide();
            $("#final-questions").show();
        }
    </script>

    <!-- <script>
        !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.async=!0,p.src=s.api_host+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
        posthog.init('phc_wNcrb8oswR8euEACD1JS5sRhcIPRWzOEBeWk9dBwONE',{api_host:'https://app.posthog.com'})
    </script> -->
    <!-- OpenReplay Tracking Code for my first project -->
<!-- OpenReplay Tracking Code for my first project -->
<script>
    var initOpts = {
      projectKey: "MwcOLDkEU3aCTOBSJRQZ",
      defaultInputMode: 0,
      obscureTextNumbers: false,
      obscureTextEmails: true,
    };
    var startOpts = { userID: "" };
    (function(A,s,a,y,e,r){
      r=window.OpenReplay=[e,r,y,[s-1, e]];
      s=document.createElement('script');s.src=A;s.async=!a;
      document.getElementsByTagName('head')[0].appendChild(s);
      r.start=function(v){r.push([0])};
      r.stop=function(v){r.push([1])};
      r.setUserID=function(id){r.push([2,id])};
      r.setUserAnonymousID=function(id){r.push([3,id])};
      r.setMetadata=function(k,v){r.push([4,k,v])};
      r.event=function(k,p,i){r.push([5,k,p,i])};
      r.issue=function(k,p){r.push([6,k,p])};
      r.isActive=function(){return false};
      r.getSessionToken=function(){};
    })("//static.openreplay.com/latest/openreplay.js",1,0,initOpts,startOpts);
  </script>
</head>
<style>
    #mergely-splash { display: none !important;}
    .mark {
        background-color: yellow;/*#ffebe9;*/
    }
    .mark-green {
        background-color: #e9ffe9;
    }
</style>
<body>
    <div>
        <p><h1>Instructions</h1></p>
        <p>We are now going to show you the code changes to review. The old version of the code is on the left, the new version is on the right.</p>
        <p>For the scientific validity of this experiment, it is vital that the review task is taken <b>very seriously</b>.</p>
        <ul>
            <li>Like in real life, you should <b>find as many defects as possible</b> and you should <b>spend as little time as possible</b> on the review.</li>
            <li>Unlike in real life, we are <b>not interested in maintainability or design issues</b>, but only in correctness issues ("bugs").</li>
        </ul>

        <p>For example, a remark like the following is beyond the goal of the review: "Create a new class which is implemented by runnable interface that we can access multiple times."
            Instead, what we are interested in are the defects that make the code not work as intended under all circumstances.</p>

        <p>Please assume that the code compiles and that the tests pass.</p>
        <p>
            To add a review remark, click on the corresponding line number. To delete a review mark, click on it again and delete the remark's text.<br><br>
        </p>

    </div>
    <div>
        <form method="get" id="button-continue">
            <button type="button" class="button blue" style="height: 50px;">I have read the instructions and I want to start the review ►</button><br><br>
        </form>
    </div>
    <div class="mergely-full-screen-8" style="overflow-y: scroll; display: none" id="div-mergely">
        <div class="mergely-resizer">
            {% for code in codes %}
                <table width="100%">
                    <tbody>
                        <tr>
                            <td width="50%">{{ code['filename'] }}</td>
                            <td>{{ code['filename'] }}</td>
                        </tr>
                    </tbody>
                </table>
                <div id="compare{{code['id']}}" class="hunk"></div><br/>
            {% endfor %}
        </div>
        <div style="clear: both;">
            <button id="review-completed" class="button blue" onclick="showquestions();">I have completed my review</button>
        </div>
        <div style="clear: both; display: none" id="final-questions">
            <form action="experiment_concluded" method="post" id="current_form">
                <!-- "diff_data" is a fieldset with a textarea inside containing JSON formatted log data. Doing this
                we do not need to manipulate data in a submission function due Flask post request mechanics-->
                <fieldset id="diff_data" hidden>
                    <textarea name="hidden_log" id="hidden_log"></textarea>
                </fieldset>
                 {{ md_body|safe }}
                <br>
                <fieldset id="fieldset_question_5" class="container_radio_buttons">
                    <p>How long have you been interrupted during the execution of the review?</p>
                    <label><input type="radio" name="question_interruption_time" id="question_interruption_time_a0" value="0" class="option-input radio" required>No interruption time</label><br>
                    <label><input type="radio" name="question_interruption_time" id="question_interruption_time_a1" value="1" class="option-input radio">1-2 minutes</label><br>
                    <label><input type="radio" name="question_interruption_time" id="question_interruption_time_a2" value="2" class="option-input radio">up to 5 minutes</label><br>
                    <label><input type="radio" name="question_interruption_time" id="question_interruption_time_a3" value="3" class="option-input radio">up to 10 minutes</label><br>
                    <label><input type="radio" name="question_interruption_time" id="question_interruption_time_a4" value="4" class="option-input radio">more than 10 minutes</label><br>
                </fieldset>
                <br>
                <button type="submit" id="submitter" class="button blue">Next ►</button>
            </form>
        </div>
    </div>
</body>
</html>